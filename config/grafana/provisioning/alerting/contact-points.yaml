apiVersion: 1

# ==============================================================================
# XRPL Monitor Alert Contact Points
# ==============================================================================
# Configure where alert notifications are sent.
#
# MULTI-CHANNEL SUPPORT:
# - Uncomment any contact points you want to enable
# - All 14 alert rules will send to ALL enabled contact points
# - You can use Email + Discord + Slack all at once!
#
# SETUP:
# 1. Uncomment the contact point(s) you want to use
# 2. Add your webhook URL or email settings
# 3. Recreate Grafana: docker compose up -d grafana --force-recreate
# 4. Test: Trigger an alert or use "Test" button in Grafana UI
# ==============================================================================

contactPoints:
  # ----------------------------------------------------------------------------
  # EMAIL NOTIFICATIONS
  # ----------------------------------------------------------------------------
  # Requires SMTP configuration in docker-compose.yml
  # See INSTALLATION.md for SMTP setup instructions

  - orgId: 1
    name: xrpl-monitor-email
    receivers:
      - uid: xrpl-email
        type: email
        settings:
          addresses: your-email@example.com
          singleEmail: false
        disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # DISCORD WEBHOOK (Recommended for XRPL community)
  # ----------------------------------------------------------------------------
  # SETUP:
  # 1. Open your Discord server
  # 2. Go to Server Settings â†’ Integrations â†’ Webhooks
  # 3. Click "New Webhook" or edit existing one
  # 4. Choose channel (e.g., #validator-alerts)
  # 5. Copy webhook URL
  # 6. Paste below and uncomment
  #
  # RESULT: Rich embeds with color-coded severity, instant mobile notifications

  # - orgId: 1
  #   name: discord-alerts
  #   receivers:
  #     - uid: discord-receiver
  #       type: discord
  #       settings:
  #         url: https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN
  #         title: "ðŸ”” {{ .GroupLabels.alertname }}"
  #         message: |-
  #           **Status:** {{ .Status }}
  #           **Summary:** {{ .CommonAnnotations.summary }}
  #           **Description:** {{ .CommonAnnotations.description }}
  #           **Severity:** {{ .CommonLabels.severity }}
  #         use_discord_username: true
  #       disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # SLACK WEBHOOK (Popular for teams)
  # ----------------------------------------------------------------------------
  # SETUP:
  # 1. Go to https://api.slack.com/messaging/webhooks
  # 2. Click "Create your Slack app" â†’ "From scratch"
  # 3. Name it "XRPL Monitor" and select your workspace
  # 4. Activate "Incoming Webhooks" toggle
  # 5. Click "Add New Webhook to Workspace"
  # 6. Choose channel (e.g., #validator-alerts)
  # 7. Copy webhook URL
  # 8. Paste below and uncomment
  #
  # RESULT: Formatted messages in Slack channel with alert details

  # - orgId: 1
  #   name: slack-alerts
  #   receivers:
  #     - uid: slack-receiver
  #       type: slack
  #       settings:
  #         url: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
  #         title: "{{ .GroupLabels.alertname }}"
  #         text: |-
  #           *Status:* {{ .Status }}
  #           *Summary:* {{ .CommonAnnotations.summary }}
  #           *Description:* {{ .CommonAnnotations.description }}
  #           *Severity:* {{ .CommonLabels.severity }}
  #       disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # MICROSOFT TEAMS WEBHOOK (Enterprise teams)
  # ----------------------------------------------------------------------------
  # SETUP:
  # 1. Open Microsoft Teams
  # 2. Navigate to your channel
  # 3. Click â‹¯ (More options) â†’ Connectors
  # 4. Search for "Incoming Webhook" and click "Add"
  # 5. Name it "XRPL Monitor" and upload optional image
  # 6. Copy webhook URL
  # 7. Paste below and uncomment
  #
  # RESULT: Card-style alerts in Teams channel

  # - orgId: 1
  #   name: teams-alerts
  #   receivers:
  #     - uid: teams-receiver
  #       type: webhook
  #       settings:
  #         url: https://outlook.office.com/webhook/YOUR_WEBHOOK_URL
  #         httpMethod: POST
  #         maxAlerts: 10
  #       disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # GENERIC WEBHOOK (Send to any HTTP endpoint)
  # ----------------------------------------------------------------------------
  # Send JSON payload to any custom endpoint
  # Useful for: Custom integrations, IFTTT, Zapier, n8n, custom scripts
  #
  # PAYLOAD EXAMPLE:
  # {
  #   "status": "firing",
  #   "alerts": [{
  #     "labels": { "alertname": "ValidatorNotProposing", "severity": "critical" },
  #     "annotations": { "summary": "Validator stopped proposing", "description": "..." }
  #   }]
  # }

  # - orgId: 1
  #   name: custom-webhook
  #   receivers:
  #     - uid: custom-receiver
  #       type: webhook
  #       settings:
  #         url: https://your-custom-endpoint.com/webhook
  #         httpMethod: POST
  #         maxAlerts: 10
  #         # Optional: Add authentication headers
  #         # authorization_scheme: Bearer
  #         # authorization_credentials: YOUR_API_TOKEN
  #       disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # PAGERDUTY (24/7 on-call incident management)
  # ----------------------------------------------------------------------------
  # SETUP:
  # 1. Log in to PagerDuty
  # 2. Go to Services â†’ Add New Service
  # 3. Name: "XRPL Validator Monitor"
  # 4. Integration Type: "Use our API directly" â†’ Events API v2
  # 5. Copy Integration Key
  # 6. Paste below and uncomment
  #
  # RESULT: Critical alerts trigger PagerDuty incidents with phone/SMS escalation

  # - orgId: 1
  #   name: pagerduty-alerts
  #   receivers:
  #     - uid: pagerduty-receiver
  #       type: pagerduty
  #       settings:
  #         integrationKey: YOUR_INTEGRATION_KEY
  #         severity: critical
  #         class: validator
  #         component: xrpl-monitor
  #       disableResolveMessage: false

  # ----------------------------------------------------------------------------
  # TELEGRAM (Simple mobile notifications)
  # ----------------------------------------------------------------------------
  # SETUP:
  # 1. Open Telegram and search for @BotFather
  # 2. Send /newbot and follow prompts to create bot
  # 3. Copy bot token (looks like: 123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11)
  # 4. Create a channel or group and add your bot as admin
  # 5. Get chat ID: Send message to channel, visit:
  #    https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates
  # 6. Look for "chat":{"id": in response (e.g., -1001234567890)
  # 7. Paste below and uncomment
  #
  # RESULT: Instant Telegram messages on your phone

  # - orgId: 1
  #   name: telegram-alerts
  #   receivers:
  #     - uid: telegram-receiver
  #       type: telegram
  #       settings:
  #         bottoken: YOUR_BOT_TOKEN
  #         chatid: YOUR_CHAT_ID
  #         message: |-
  #           ðŸ”” *{{ .GroupLabels.alertname }}*
  #
  #           *Status:* {{ .Status }}
  #           *Summary:* {{ .CommonAnnotations.summary }}
  #           *Severity:* {{ .CommonLabels.severity }}
  #         parse_mode: Markdown
  #       disableResolveMessage: false

# ==============================================================================
# TESTING YOUR SETUP
# ==============================================================================
# After enabling contact points:
#
# 1. Via Grafana UI:
#    - Go to Alerting â†’ Contact points
#    - Click "Test" button next to your contact point
#    - Should receive test notification immediately
#
# 2. Via Actual Alert:
#    - Wait for an alert condition to trigger
#    - Or temporarily modify alert threshold to force trigger
#
# 3. Check Grafana Logs:
#    docker compose logs grafana | grep -i "alert\|notification"
#
# ==============================================================================
# TROUBLESHOOTING
# ==============================================================================
# No notifications received?
#
# 1. Check contact point is uncommented and webhook URL is correct
# 2. Restart Grafana: docker compose restart grafana
# 3. Check Grafana logs: docker compose logs grafana | grep -i error
# 4. Test webhook URL manually:
#    curl -X POST "YOUR_WEBHOOK_URL" -H "Content-Type: application/json" \
#      -d '{"text":"Test from XRPL Monitor"}'
# 5. Verify alert rules are firing: Alerting â†’ Alert rules
#
# ==============================================================================
